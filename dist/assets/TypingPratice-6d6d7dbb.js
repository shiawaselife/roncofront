import{r,y as I,n as B,b0 as U,d as x,b as e,K as T,t as l,F as V,p as z,I as F,O as N,aa as P,R as L,L as S,x as D,o as f}from"./index-bd052fb4.js";const W={class:"max-w-4xl mx-auto px-4 sm:px-6 lg:px-8"},O={class:"bg-white rounded-lg shadow mb-6 p-4"},q={class:"flex justify-center gap-4"},G={class:"bg-white rounded-lg shadow mb-6"},H={class:"grid grid-cols-4 gap-4 p-4"},J={class:"text-center"},Q=e("div",{class:"text-sm font-medium text-gray-500"},"정확도",-1),X={class:"mt-1 text-2xl font-semibold text-gray-900"},Y={class:"text-center border-l border-gray-200"},Z=e("div",{class:"text-sm font-medium text-gray-500"},l("분당 타자수"),-1),ee={class:"mt-1 text-2xl font-semibold text-gray-900"},te={class:"text-center border-l border-gray-200"},se={class:"text-sm font-medium text-gray-500"},oe={class:"mt-1 text-2xl font-semibold text-gray-900"},ae={class:"text-center border-l border-gray-200"},le=e("div",{class:"text-sm font-medium text-gray-500"},"남은 시간",-1),ne={class:"mt-1 text-2xl font-semibold text-gray-900"},re={class:"bg-white rounded-lg shadow p-6 mb-6"},ie={class:"text-lg leading-relaxed whitespace-pre-wrap"},ce={class:"bg-white rounded-lg shadow p-6 mb-6"},ue=["disabled"],de={class:"flex justify-center gap-4"},ge=["onClick","onKeydown"],ve={class:"bg-white rounded-lg max-w-md w-full mx-4"},he={class:"p-6"},xe=e("h2",{class:"text-2xl font-bold text-gray-900 mb-4"},"연습 결과",-1),fe={class:"space-y-4"},me={class:"flex justify-between items-center"},pe=e("span",{class:"text-gray-600"},"최종 WPM",-1),_e={class:"text-xl font-semibold text-gray-900"},be={class:"flex justify-between items-center"},ye=e("span",{class:"text-gray-600"},"정확도",-1),we={class:"text-xl font-semibold text-gray-900"},Ce={class:"flex justify-between items-center"},ke=e("span",{class:"text-gray-600"},"완료한 문자",-1),Ie={class:"text-xl font-semibold text-gray-900"},Te={class:"flex justify-between items-center"},Me=e("span",{class:"text-gray-600"},"분당 타자수",-1),je={class:"text-xl font-semibold text-gray-900"},Le={__name:"TypingPratice",setup(Ae){const i=r(""),s=r(""),u=r(!1),c=r(null),m=r(0),v=r(60),h=r(null),d=r(!1),p=r(!1),g=r("en"),_=I(()=>{if(!s.value.length)return 0;let o=0;for(let t=0;t<s.value.length;t++)s.value[t]===i.value[t]&&o++;return Math.round(o/s.value.length*100)}),M=o=>{let t=0;for(let a=0;a<o.length;a++){const n=o[a];/[가-힣]/.test(n)?(n.charCodeAt(0)>44032&&t++,(n.charCodeAt(0)-44032)%28>0&&t++,(n.charCodeAt(0)-44032)%28>0&&t++):t++}return t},b=I(()=>{if(!c.value||!s.value.length)return 0;const o=(Date.now()-c.value)/1e3/60,t=M(s.value);return Math.round(t/o)}),y=I(()=>{if(!c.value||!s.value.length)return 0;const o=(Date.now()-c.value)/1e3/60,t=M(s.value);return Math.round(t/8/o)}),K=()=>{!u.value&&s.value.length>0&&E(),$()},$=()=>{m.value=s.value.length,s.value.length===i.value.length&&j()},E=()=>{u.value=!0,c.value=Date.now(),h.value=setInterval(()=>{v.value--,v.value<=0&&(p.value=!0,j())},1e3)},j=()=>{u.value=!1,clearInterval(h.value),d.value=!0,R()},R=async()=>{try{await D.post("http://localhost:8080/api/typing/results",{studentId:localStorage.getItem("studentId"),cpm:b.value,wpm:y.value,accuracy:_.value,textLength:i.value.length,completedLength:s.value.length})}catch(o){console.error("결과 저장 실패:",o)}},w=()=>{clearInterval(h.value),s.value="",u.value=!1,c.value=null,m.value=0,v.value=60,p.value=!1,d.value=!1,k()},C=()=>{d.value=!1,w()},A=async o=>{g.value=o,u.value?w():await k()},k=async()=>{try{const o=await D.get(`http://localhost:8080/api/typing/texts/random?language=${g.value}`);i.value=o.data.content}catch(o){console.error("텍스트 가져오기 실패:",o),i.value="기본 연습 텍스트입니다. 이것은 서버 연결에 실패했을 때 표시됩니다."}};return B(()=>{k()}),U(()=>{clearInterval(h.value)}),(o,t)=>(f(),x("div",W,[e("div",O,[e("div",q,[e("button",{onClick:t[0]||(t[0]=a=>A("en")),class:T(["px-4 py-2 rounded-lg font-medium",g.value==="en"?"bg-blue-600 text-white":"bg-gray-200 text-gray-700 hover:bg-gray-300"])}," English ",2),e("button",{onClick:t[1]||(t[1]=a=>A("ko")),class:T(["px-4 py-2 rounded-lg font-medium",g.value==="ko"?"bg-blue-600 text-white":"bg-gray-200 text-gray-700 hover:bg-gray-300"])}," 한글 ",2)])]),e("div",G,[e("div",H,[e("div",J,[Q,e("div",X,l(_.value)+"%",1)]),e("div",Y,[Z,e("div",ee,l(b.value),1)]),e("div",te,[e("div",se,l(g.value==="ko"?"분당 단어수":"WPM"),1),e("div",oe,l(y.value),1)]),e("div",ae,[le,e("div",ne,l(v.value)+"초",1)])])]),e("div",re,[e("div",ie,[(f(!0),x(V,null,z(i.value,(a,n)=>(f(),x("span",{key:n,class:T({"text-gray-600":!s.value[n],"text-green-500":s.value[n]===a,"text-red-500 underline":s.value[n]&&s.value[n]!==a,"bg-blue-50":m.value===n})},l(a),3))),128))])]),e("div",ce,[F(e("textarea",{"onUpdate:modelValue":t[2]||(t[2]=a=>s.value=a),onInput:K,onKeydown:t[3]||(t[3]=P(L(()=>{},["prevent"]),["enter"])),disabled:p.value||d.value,placeholder:"타이핑을 시작하면 자동으로 시작됩니다...",class:"w-full h-32 p-4 text-lg border border-gray-300 rounded-lg resize-none focus:ring-2 focus:ring-blue-500 focus:border-transparent disabled:bg-gray-50 disabled:text-gray-500"},null,40,ue),[[N,s.value]])]),e("div",de,[e("button",{onClick:w,class:"px-6 py-3 text-lg font-medium text-white bg-gray-600 rounded-lg hover:bg-gray-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-gray-500 transition-colors"}," 재시작 "),e("button",{onClick:t[4]||(t[4]=a=>o.$router.push("/s")),class:"px-6 py-3 text-lg font-medium text-white bg-red-600 rounded-lg hover:bg-red-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-red-500 transition-colors"}," 나가기 ")]),d.value?(f(),x("div",{key:0,class:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center",onClick:L(C,["self"]),onKeydown:P(C,["esc"]),tabindex:"0"},[e("div",ve,[e("div",he,[xe,e("div",fe,[e("div",me,[pe,e("span",_e,l(y.value),1)]),e("div",be,[ye,e("span",we,l(_.value)+"%",1)]),e("div",Ce,[ke,e("span",Ie,l(s.value.length)+"/"+l(i.value.length),1)]),e("div",Te,[Me,e("span",je,l(b.value),1)])])]),e("div",{class:"bg-gray-50 px-6 py-4 rounded-b-lg"},[e("button",{onClick:C,class:"w-full px-4 py-2 text-lg font-medium text-white bg-blue-600 rounded-lg hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 transition-colors"}," 닫기 ")])])],40,ge)):S("",!0)]))}};export{Le as default};
