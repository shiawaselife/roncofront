import{d as x}from"./dayjs.min-773be4ac.js";import{r as m,y as M,n as j,c as L,w as T,_ as N,x as B,o as l,a as R,b as t,d as i,u as y,aX as V,aY as H,t as g,aZ as P,p as b,K as v,F as w,L as $,j as q}from"./index-c5ab3c5b.js";const z={class:"p-6 min-h-screen bg-gray-50"},E={class:"bg-gradient-to-r from-blue-50 to-indigo-50 rounded-xl p-6 mb-6 shadow-sm"},K={class:"flex items-center"},X={class:"w-8 h-8 text-blue-600",viewBox:"0 0 24 24"},Z=["d"],G=t("h1",{class:"text-2xl font-bold text-gray-800 ml-3"},"날짜별 수업 목록",-1),J={class:"grid grid-cols-5 gap-6"},Q={class:"col-span-2"},U={class:"bg-white rounded-xl shadow-sm overflow-hidden sticky top-6"},W={class:"bg-gradient-to-b from-gray-50 border-b border-gray-100 p-4"},tt={class:"flex items-center justify-between"},et={class:"w-5 h-5 text-gray-600",viewBox:"0 0 24 24"},st=["d"],at={class:"text-lg font-semibold text-gray-800"},nt={class:"w-5 h-5 text-gray-600",viewBox:"0 0 24 24"},ot=["d"],rt={class:"p-4"},lt={class:"grid grid-cols-7 gap-1"},it=["onClick"],ct={key:0,class:"absolute bottom-1 w-1.5 h-1.5 rounded-full bg-blue-400"},dt={class:"col-span-3"},ut={class:"bg-white rounded-xl shadow-sm overflow-hidden"},gt={class:"border-b border-gray-100 p-6"},pt={class:"text-lg font-semibold text-gray-800"},ht={class:"p-6"},_t={class:"overflow-x-auto"},xt={class:"w-full"},mt=t("thead",null,[t("tr",{class:"border-b border-gray-100"},[t("th",{class:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"시간"),t("th",{class:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"학생"),t("th",{class:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"수업 종류"),t("th",{class:"px-4 py-3 text-center text-xs font-medium text-gray-500 uppercase tracking-wider"},"상태")])],-1),ft={class:"divide-y divide-gray-100"},vt={class:"px-4 py-3 text-sm text-gray-900 whitespace-nowrap"},yt={class:"px-4 py-3 text-sm font-medium text-gray-900"},bt={class:"px-4 py-3 text-sm"},wt={key:0,class:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-purple-100 text-purple-800"},Dt={key:1,class:"text-gray-600"},kt={class:"px-4 py-3 text-sm text-center"},Ct={key:0},St=t("td",{colspan:"4",class:"px-4 py-8 text-center text-gray-500"}," 이 날짜에는 예정된 수업이 없습니다. ",-1),Yt=[St],$t={__name:"ClassCalendar",setup(Mt){const c=m(new Date().getFullYear()),d=m(new Date().getMonth()),h=m(x().format("YYYY-MM-DD")),_=m({}),D=m({}),I=M(()=>{const a=new Date(c.value,d.value,1),s=[],e=a.getDay(),p=new Date(c.value,d.value,0);for(let o=e-1;o>=0;o--){const r=new Date(c.value,d.value-1,p.getDate()-o);s.push({date:r.toISOString().split("T")[0],current:!1,hasClasses:!!_.value[r.toISOString().split("T")[0]]})}const u=new Date(c.value,d.value+1,0);for(let o=1;o<=u.getDate();o++){const r=new Date(c.value,d.value,o);s.push({date:r.toISOString().split("T")[0],current:!0,hasClasses:!!_.value[r.toISOString().split("T")[0]]})}const n=u.getDay();for(let o=1;o<7-n;o++){const r=new Date(c.value,d.value+1,o);s.push({date:r.toISOString().split("T")[0],current:!1,hasClasses:!!_.value[r.toISOString().split("T")[0]]})}return s}),k=M(()=>_.value[h.value]||[]);function C(a){const s=new Date(c.value,d.value+a,1);c.value=s.getFullYear(),d.value=s.getMonth(),Y()}function O(a){h.value=a}function f(a){return h.value===a}function A(a){const s=new Date(a),e=["일","월","화","수","목","금","토"];return`${s.getFullYear()}년 ${s.getMonth()+1}월 ${s.getDate()}일 (${e[s.getDay()]})`}function S(a){const s=x(),e=x(a.classDate),u=(D.value[a.classDate]||[]).some(o=>o.studentId===a.student.id&&o.attendanceDate===a.classDate);if(e.isAfter(s,"day"))return"예정";if(e.isBefore(s,"day"))return u?"완료":"결석";const n=s.format("HH:mm");return n<a.startTime?"예정":n>a.endTime?u?"완료":"결석":u?"진행중":"미출석"}function F(a){switch(S(a)){case"예정":return"bg-gray-100 text-gray-600";case"진행중":return"bg-green-100 text-green-600";case"완료":return"bg-blue-100 text-blue-600";case"결석":return"bg-red-100 text-red-600";case"미출석":return"bg-yellow-100 text-yellow-600";default:return"bg-gray-100 text-gray-600"}}async function Y(){try{const a=x(new Date(c.value,d.value,1)).format("YYYY-MM-DD"),s=x(new Date(c.value,d.value+1,0)).format("YYYY-MM-DD"),e=await B.get("/api/classes/range",{params:{startDate:a,endDate:s}});_.value=e.data.reduce((n,o)=>{const r=o.classDate;return n[r]||(n[r]=[]),n[r].push(o),n},{});const p=Array.from(new Set(e.data.map(n=>n.student.id))).map(n=>B.get(`/api/attendance/${n}`)),u=await Promise.all(p);D.value=u.flatMap(n=>n.data).reduce((n,o)=>{const r=o.attendanceDate;return n[r]||(n[r]=[]),n[r].push(o),n},{})}catch(a){console.error("데이터 조회 실패:",a),alert("데이터를 불러오는데 실패했습니다.")}}return j(()=>{Y()}),(a,s)=>(l(),L(N,null,{default:T(()=>[R(q,null,{default:T(()=>[t("div",z,[t("div",E,[t("div",K,[(l(),i("svg",X,[t("path",{fill:"currentColor",d:y(V)},null,8,Z)])),G])]),t("div",J,[t("div",Q,[t("div",U,[t("div",W,[t("div",tt,[t("button",{class:"p-2 hover:bg-gray-100 rounded-lg transition-colors",onClick:s[0]||(s[0]=e=>C(-1))},[(l(),i("svg",et,[t("path",{fill:"currentColor",d:y(H)},null,8,st)]))]),t("h2",at,g(c.value)+"년 "+g(d.value+1)+"월 ",1),t("button",{class:"p-2 hover:bg-gray-100 rounded-lg transition-colors",onClick:s[1]||(s[1]=e=>C(1))},[(l(),i("svg",nt,[t("path",{fill:"currentColor",d:y(P)},null,8,ot)]))])])]),t("div",rt,[t("div",lt,[(l(),i(w,null,b(["일","월","화","수","목","금","토"],e=>t("div",{key:e,class:v(["text-center py-2 text-sm font-medium",e==="일"?"text-red-500":e==="토"?"text-blue-500":"text-gray-600"])},g(e),3)),64)),(l(!0),i(w,null,b(I.value,({date:e,current:p,hasClasses:u})=>(l(),i("div",{key:e,class:"aspect-square p-0.5"},[t("button",{class:v(["w-full h-full rounded-lg flex flex-col items-center justify-center relative transition-all duration-200",[p?"hover:bg-blue-50":"opacity-30",f(e)?"bg-blue-500 text-white hover:bg-blue-600 shadow-sm":"",u&&!f(e)?"bg-blue-50":""]]),onClick:n=>O(e)},[t("span",{class:v(["text-sm",f(e)?"font-semibold":""])},g(new Date(e).getDate()),3),u&&!f(e)?(l(),i("div",ct)):$("",!0)],10,it)]))),128))])])])]),t("div",dt,[t("div",ut,[t("div",gt,[t("h3",pt,g(h.value?A(h.value):"날짜를 선택하세요"),1)]),t("div",ht,[t("div",_t,[t("table",xt,[mt,t("tbody",ft,[(l(!0),i(w,null,b(k.value,e=>(l(),i("tr",{key:e.id,class:"hover:bg-gray-50 transition-colors"},[t("td",vt,g(e.startTime)+" ~ "+g(e.endTime),1),t("td",yt,g(e.student.name),1),t("td",bt,[e.makeup?(l(),i("span",wt,g(e.makeupType),1)):(l(),i("span",Dt,"정규수업"))]),t("td",kt,[t("span",{class:v(["inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium",F(e)])},g(S(e)),3)])]))),128)),k.value.length===0?(l(),i("tr",Ct,Yt)):$("",!0)])])])])])])])])]),_:1})]),_:1}))}};export{$t as default};
